syntax = "proto3";

package api.v1;

import "google/api/annotations.proto";
import "google/api/field_behavior.proto";
import "protoc-gen-openapiv2/options/annotations.proto";
import "validate/validate.proto";

option go_package = "gitlab.playpod.ir/alpha/backend/server-services-next/gen/go/api/v1;apiv1";

// GoogleServiceCallbackRequest is a message.
message GoogleServiceCallbackRequest {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    example: '{"client_id":"830277491323-ck2c8denn2u0ucm29g2nl7qje1bgnet2.apps.googleusercontent.com","credential":"eyJhbGciOiJSUzI1NiIsImtpZCI6IjhlMGFjZjg5MWUwOTAwOTFlZjFhNWU3ZTY0YmFiMjgwZmQxNDQ3ZmEiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJuYmYiOjE2NzI3NTIwNjYsImF1ZCI6IjgzMDI3NzQ5MTMyMy1jazJjOGRlbm4ydTB1Y20yOWcybmw3cWplMWJnbmV0Mi5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjEwNzM1ODY0NDU4ODM1MTE2MTg5OCIsImVtYWlsIjoic21obWF5Ym91ZGlAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImF6cCI6IjgzMDI3NzQ5MTMyMy1jazJjOGRlbm4ydTB1Y20yOWcybmw3cWplMWJnbmV0Mi5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsIm5hbWUiOiJIb3NzZWluIE1heWJvdWRpIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FFZEZUcDdFeEREYXhUdFlLQVZyYkZGSVBqVE1uRGo5NWdFVlhnM09fY2owdUE9czk2LWMiLCJnaXZlbl9uYW1lIjoiSG9zc2VpbiIsImZhbWlseV9uYW1lIjoiTWF5Ym91ZGkiLCJpYXQiOjE2NzI3NTIzNjYsImV4cCI6MTY3Mjc1NTk2NiwianRpIjoiOTkzYzk0YjhmNzU1MjhlZDU4N2FjMzg5ZGU0NjI1ZjY5YTFhN2IwZiJ9.J2-bPyZLB3-WWKkuR_Jpf5MXzGCglFtaJhq9susc5OAFKWWzpr_-SZ1fYnyQMtHZPgcM0sOMuZ353gttTGu0gFkd78suxkCbOJHiirl25TovKMf8Hjpw5GyFAotlRaXH_qmXYgRmlto9lQQjgiQRz3vwUsrzIG2SneW4Vr1taVfIYR8jhr86zw9yq1RzVBpvAwjIg4qSNAZPRhQp7Do5_4yTAYLW6hWFiKIfNZe6IurX5P6iUi6284jDYosE9N3v_2AbuW9EgShnhEKnr-iKrqkDN4CxrYw2Gxj5DzhEWh7jQA1PdydvuOS5CUs8O1jGy8c4E1i-cP5kO5gBuVHAKQ"}',
    external_docs: {
      description: "Find out more about GoogleServiceCallbackRequest",
      url: "https://gitlab.playpod.ir/alpha/backend/server-services-next",
    },
    json_schema: {
      description: "A google service callback request",
      required: [
        "client_id",
        "credential"
      ],
      title: "GoogleServiceCallbackRequest Message",
    },
    read_only: false,
  };
  // Required. client_id is a property.
  string client_id = 1 [
    (google.api.field_behavior) = REQUIRED,
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {description: "The client_id field."},
    (validate.rules) = {
      string: {ignore_empty: true}
    }
  ];
  // Required. credential is a property.
  string credential = 2 [
    (google.api.field_behavior) = REQUIRED,
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {description: "The credential field."},
    (validate.rules) = {
      string: {ignore_empty: true}
    }
  ];
}

// GoogleServiceCallbackResponse is a message.
message GoogleServiceCallbackResponse {
  option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_schema) = {
    example: '{"user_id":"00000000-0000-0000-0000-000000000001"}',
    external_docs: {
      description: "Find out more about GoogleServiceCallbackResponse",
      url: "https://gitlab.playpod.ir/alpha/backend/server-services-next",
    },
    json_schema: {
      description: "A google service callback response",
      title: "GoogleServiceCallbackResponse Message",
    },
    read_only: true,
  };
  // user_id is a property.
  string user_id = 1 [
    (google.api.field_behavior) = OPTIONAL,
    (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_field) = {description: "The user_id field."},
    (validate.rules) = {
      string: {
        ignore_empty: true,
        uuid: true
      }
    }
  ];
}

// GoogleService is a service.
service GoogleService {
  // Callback is a rpc.
  rpc Callback(GoogleServiceCallbackRequest) returns (GoogleServiceCallbackResponse) {
    option (google.api.http) = {
      body: "*",
      post: "/api/v1/googles:callback",
    };
    option (grpc.gateway.protoc_gen_openapiv2.options.openapiv2_operation) = {
      security: {
        security_requirement: {},
      },
    };
  }
}
